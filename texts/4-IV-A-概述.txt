平衡规划是在不同时期进行的。在每一个时期开始时，节点估计其对相应收款人的预期付款。每个时期的长度取决于支付需求的估计精度和区块链访问开销之间的权衡。较长的时间段可以减少区块链访问的频率，但由于需要处理更多的交易，因此需要将更多的硬币锁定到通道中。另外，由于支付估计的误差越来越大，使得余额规划算法的设计变得更加困难。另一方面，由于时间较短，很容易以较小的误差估计支付需求，但存款较少的支付通道可能会很快耗尽，导致区块链操作频繁。
支付网络本质上是一个带有恶意节点的分布式系统。依靠集中控制或可信的第三方来运行平衡计划算法是不安全的，因为它们可能会被恶意节点破坏。在每个时期开始时，PnP使用密码排序随机选择一组节点，称为决策委员会，负责运行平衡规划算法。加密排序可以在分布式环境中工作，不需要节点间的交互操作。如
**Procedure 1中所示的第一行，函数Sortition（·）将私钥和其他信息作为输入，并返回一个布尔值si，该值指示节点i是否被选为决策委员会成员。同时，它还返回一个hash值hashi和一个proof πi，用来验证排序结果的正确性。虽然[15]提出了一种类似的排序方法，但它的目标是对区块提案进行投票，不能直接应用于我们的场景。
被选为决策委员会成员的节点使用Gossip协议传播其排序结果。同时，每个节点监听通信信道并接收排序结果。对于每个接收到的排序消息，节点i使用函数VerifySortition（·）验证其正确性，并通过包含sj=True的任何节点j来维护决策委员会，如
**Procedure 1第7-11行所示。一旦决策委员会成立，所有节点将各自的预算、支付需求和相邻信息发送给决策委员会。决策委员会成员独立解决平衡规划问题。需要注意的是，恶意节点可能会被选入决策委员会，他们可以任意操纵balance g结果。因此，PnP在决策委员会成员之间运行PBFT[16]协议，以便他们能够就正确的规划结果达成一致。然后将规划结果发送到网络中相应的节点。